<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download SignSpeak App - Install PWA</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ASL Web">
    <link rel="apple-touch-icon" href="static/image/icon-192.png">
    
    <meta name="description" content="Install SignSpeak as an app on your device for the best ASL learning experience">
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="static/css/download.css">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>SignSpeak</h1>
            <div class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <nav>
                <a href="index.html">Home</a>
                <a href="text_to_sign.html">Text to Sign</a>
                <a href="image_to_sign.html">Image to Sign</a>
                <a href="webcam.html">Webcam</a>
                <a href="alphabet.html">Learn Alphabet</a>
                <a href="download.html" class="active">Download App</a>
                <button id="navInstallButton" class="nav-install-btn" style="display: none;">
                    üì± Install App
                </button>
            </nav>
        </div>
    </header>

    <main>
        <section class="download-hero">
            <div class="container">
                <div class="hero-content">
                    <div class="app-icon">
                        <div class="icon-placeholder">
                            <span>üì±</span>
                        </div>
                    </div>
                    <h1>Get SignSpeak App</h1>
                    <p class="hero-subtitle">Install SignSpeak on your device for the best ASL learning experience. Works offline and feels like a native app!</p>
                    
                    <div class="install-buttons">
                        <button id="primaryInstallButton" class="install-btn primary">
                            <span class="icon">üì±</span>
                            <div class="btn-text">
                                <span class="title">Install App</span>
                                <span class="subtitle">Add to your device</span>
                            </div>
                        </button>
                        
                        <div id="installStatus" class="install-status">
                            <p>Click the button above to install SignSpeak as an app on your device!</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="installation-guide">
            <div class="container">
                <h2>üìñ Installation Guide</h2>
                
                <div class="device-tabs">
                    <button class="tab-btn active" data-tab="mobile">üì± Mobile</button>
                    <button class="tab-btn" data-tab="desktop">üíª Desktop</button>
                </div>

                <!-- Mobile Instructions -->
                <div id="mobile" class="tab-content active">
                    <div class="instruction-cards">
                        <div class="card android">
                            <div class="card-header">
                                <span class="icon">ü§ñ</span>
                                <h3>Android Devices</h3>
                                <span class="browsers">Chrome, Edge, Samsung Internet</span>
                            </div>
                            <div class="steps">
                                <div class="step">
                                    <span class="step-number">1</span>
                                    <div class="step-content">
                                        <h4>Visit SignSpeak</h4>
                                        <p>Open this website in Chrome, Edge, or Samsung Internet</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">2</span>
                                    <div class="step-content">
                                        <h4>Look for Install Prompt</h4>
                                        <p>Tap "Install App" when the banner appears, or use the button in navigation</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">3</span>
                                    <div class="step-content">
                                        <h4>Confirm Installation</h4>
                                        <p>Tap "Install" in the popup. The app will be added to your home screen</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card ios">
                            <div class="card-header">
                                <span class="icon">üçé</span>
                                <h3>iPhone & iPad</h3>
                                <span class="browsers">Safari (recommended)</span>
                            </div>
                            <div class="steps">
                                <div class="step">
                                    <span class="step-number">1</span>
                                    <div class="step-content">
                                        <h4>Open in Safari</h4>
                                        <p>Visit this website using Safari browser</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">2</span>
                                    <div class="step-content">
                                        <h4>Tap Share Button</h4>
                                        <p>Tap the share icon (box with arrow) at the bottom</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">3</span>
                                    <div class="step-content">
                                        <h4>Add to Home Screen</h4>
                                        <p>Scroll down and tap "Add to Home Screen", then tap "Add"</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Desktop Instructions -->
                <div id="desktop" class="tab-content">
                    <div class="instruction-cards">
                        <div class="card chrome">
                            <div class="card-header">
                                <span class="icon">üåê</span>
                                <h3>Chrome & Edge</h3>
                                <span class="browsers">Windows, Mac, Linux</span>
                            </div>
                            <div class="steps">
                                <div class="step">
                                    <span class="step-number">1</span>
                                    <div class="step-content">
                                        <h4>Look for Install Icon</h4>
                                        <p>Check the address bar for a small "+" or install icon</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">2</span>
                                    <div class="step-content">
                                        <h4>Click Install</h4>
                                        <p>Click the install icon or use the "Install App" button in navigation</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">3</span>
                                    <div class="step-content">
                                        <h4>Confirm Installation</h4>
                                        <p>Click "Install" in the popup. The app will open in its own window</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card firefox">
                            <div class="card-header">
                                <span class="icon">ü¶ä</span>
                                <h3>Firefox & Other Browsers</h3>
                                <span class="browsers">All platforms</span>
                            </div>
                            <div class="steps">
                                <div class="step">
                                    <span class="step-number">1</span>
                                    <div class="step-content">
                                        <h4>Create Bookmark</h4>
                                        <p>Bookmark this page for easy access</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">2</span>
                                    <div class="step-content">
                                        <h4>Pin Tab</h4>
                                        <p>Right-click the tab and select "Pin Tab" for app-like experience</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <span class="step-number">3</span>
                                    <div class="step-content">
                                        <h4>Create Shortcut</h4>
                                        <p>Add a desktop shortcut from browser menu for quick access</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="app-benefits">
            <div class="container">
                <h2>‚ú® Why Install the App?</h2>
                <div class="benefits-grid">
                    <div class="benefit">
                        <span class="benefit-icon">‚ö°</span>
                        <h3>Faster Performance</h3>
                        <p>Cached files load instantly, no waiting for downloads</p>
                    </div>
                    <div class="benefit">
                        <span class="benefit-icon">üì¥</span>
                        <h3>Works Offline</h3>
                        <p>Practice ASL even without internet connection</p>
                    </div>
                    <div class="benefit">
                        <span class="benefit-icon">üéØ</span>
                        <h3>App-Like Experience</h3>
                        <p>Runs in its own window, feels like a native app</p>
                    </div>
                    <div class="benefit">
                        <span class="benefit-icon">üè†</span>
                        <h3>Home Screen Access</h3>
                        <p>Quick access from your device's home screen or desktop</p>
                    </div>
                    <div class="benefit">
                        <span class="benefit-icon">üîÑ</span>
                        <h3>Auto Updates</h3>
                        <p>Always get the latest features automatically</p>
                    </div>
                    <div class="benefit">
                        <span class="benefit-icon">üé®</span>
                        <h3>Full Screen</h3>
                        <p>More space for hand tracking and learning</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="troubleshooting">
            <div class="container">
                <h2>‚ùì Troubleshooting</h2>
                <div class="faq">
                    <div class="faq-item">
                        <h3>Don't see the install button?</h3>
                        <p>Make sure you're using a supported browser and have visited the site a few times. The install prompt may take a moment to appear.</p>
                    </div>
                    <div class="faq-item">
                        <h3>Installation failed?</h3>
                        <p>Try refreshing the page and attempting installation again. Make sure you have sufficient storage space on your device.</p>
                    </div>
                    <div class="faq-item">
                        <h3>App not working offline?</h3>
                        <p>Visit all the pages you want to use offline first. The app will cache them for offline use automatically.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>Developed with ‚ù§Ô∏è as part of the Capstone Project | <a href="https://github.com/Lart101/AslSignLanguageWeb">Learn More</a></p>
    </footer>

    <script src="static/js/pwa-install.js"></script>
    <script>
        // Tab switching functionality
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.dataset.tab;
                
                // Remove active class from all tabs and contents
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                button.classList.add('active');
                document.getElementById(tabName).classList.add('active');
            });
        });

        // Enhanced install button for download page
        const primaryInstallButton = document.getElementById('primaryInstallButton');
        const installStatus = document.getElementById('installStatus');
        let installAttempted = false;

        // Make install button always clickable
        primaryInstallButton.addEventListener('click', async () => {
            if (installAttempted) return;
            
            installAttempted = true;
            
            // Update button to show loading state
            primaryInstallButton.innerHTML = `
                <span class="icon">‚è≥</span>
                <div class="btn-text">
                    <span class="title">Checking...</span>
                    <span class="subtitle">Preparing installation</span>
                </div>
            `;
            primaryInstallButton.disabled = true;
            
            // Wait a moment for PWA prompt to be ready
            setTimeout(async () => {
                if (deferredPrompt) {
                    // PWA install is available
                    try {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(`User response: ${outcome}`);
                        
                        if (outcome === 'accepted') {
                            primaryInstallButton.innerHTML = `
                                <span class="icon">‚úÖ</span>
                                <div class="btn-text">
                                    <span class="title">App Installed!</span>
                                    <span class="subtitle">Check your home screen</span>
                                </div>
                            `;
                            installStatus.innerHTML = '<p style="color: #4CAF50;">‚úÖ <strong>Success!</strong> SignSpeak has been installed on your device.</p>';
                        } else {
                            // User declined
                            primaryInstallButton.innerHTML = `
                                <span class="icon">üì±</span>
                                <div class="btn-text">
                                    <span class="title">Install App</span>
                                    <span class="subtitle">Try again anytime</span>
                                </div>
                            `;
                            primaryInstallButton.disabled = false;
                            installAttempted = false;
                            installStatus.innerHTML = '<p style="color: #ff9800;">‚ÑπÔ∏è Installation was cancelled. You can try again anytime!</p>';
                        }
                        deferredPrompt = null;
                    } catch (error) {
                        console.error('Install failed:', error);
                        showManualInstructions();
                    }
                } else {
                    // PWA not ready or not supported, show manual instructions
                    showManualInstructions();
                }
            }, 1000);
        });

        function showManualInstructions() {
            primaryInstallButton.innerHTML = `
                <span class="icon">üìã</span>
                <div class="btn-text">
                    <span class="title">Manual Install</span>
                    <span class="subtitle">Follow guide below</span>
                </div>
            `;
            primaryInstallButton.disabled = true;
            installStatus.innerHTML = `
                <div style="background: #fff3cd; padding: 1rem; border-radius: 8px; border-left: 4px solid #ff9800;">
                    <p><strong>üìã Manual Installation Required</strong></p>
                    <p>Your browser doesn't support automatic installation yet. Please follow the step-by-step guide below to install SignSpeak on your device.</p>
                </div>
            `;
        }

        // Override the PWA install functionality for this page
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Update status to show PWA is ready
            installStatus.innerHTML = '<p style="color: #4CAF50;">üéâ <strong>Ready to install!</strong> Your browser supports automatic installation.</p>';
            
            // Also show nav button
            if (navInstallButton) {
                navInstallButton.style.display = 'block';
                navInstallButton.addEventListener('click', installApp);
            }
        });

        // Check if already installed
        window.addEventListener('appinstalled', () => {
            primaryInstallButton.innerHTML = `
                <span class="icon">‚úÖ</span>
                <div class="btn-text">
                    <span class="title">Already Installed</span>
                    <span class="subtitle">App is ready to use</span>
                </div>
            `;
            primaryInstallButton.disabled = true;
            installStatus.innerHTML = '<p style="color: #4CAF50;">‚úÖ <strong>SignSpeak is installed!</strong> You can find it on your home screen or app menu.</p>';
        });
    </script>
</body>
</html>
